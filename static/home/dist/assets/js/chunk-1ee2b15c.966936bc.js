(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ee2b15c"],{"0a59":function(t,e,i){"use strict";i("bcc0")},"0ff7":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"list_comment"},t._l(t.list,(function(i,s){return e("div",{key:s,staticClass:"item_comment_box"},[e("div",{staticClass:"comment"},[e("div",{staticClass:"left_block"},[e("img",{directives:[{name:"default-img",rawName:"v-default-img",value:"../../../public/img/default.png",expression:"'../../../public/img/default.png'"}],staticStyle:{width:"4rem",height:"4rem"},attrs:{src:t.$fullUrl(i[t.vm.avatar])}})]),e("div",{staticClass:"right_block"},[e("div",{staticClass:"top_comment"},[e("div",{staticClass:"nickname"},[t._v(t._s(i[t.vm.nickname]))]),e("div",{staticClass:"time_block"},[e("div",{staticClass:"time"},[t._v(" "+t._s(t._f("formatDate")(i[t.vm.create_time]))+" ")])])]),e("div",{staticClass:"content",domProps:{innerHTML:t._s(i[t.vm.content])}}),Object.keys(t.obj).length?e("div",{staticClass:"comment_reply"},[e("b-button",{attrs:{variant:"outline"},on:{click:function(e){return t.reply_to_sb(i)}}},[t._v("回复")])],1):t._e()])]),i.list_reply?e("div",{staticClass:"list_reply ml-5"},t._l(i.list_reply,(function(i,s){return e("div",{key:s,staticClass:"mb"},[e("div",{staticClass:"fl"},[e("span",{staticClass:"nickname"},[t._v(t._s(i[t.vm.nickname]))])]),e("div",{staticClass:"fr"},[e("span",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(i[t.vm.create_time])))])]),e("div",{staticClass:"ml-5",domProps:{innerHTML:t._s(i[t.vm.content])}})])})),0):t._e()])})),0)},r=[],o=i("c6e7"),a={mixins:[o["a"]],props:{list:{type:Array,default:function(){return[]}},obj:{type:Object,default:function(){return{}}},vm:{type:Object,default:function(){return{avatar:"avatar",nickname:"nickname",content:"content",create_time:"create_time"}}}},data(){return{text:""}},methods:{reply_to_sb(t){this.obj.reply_to_id=t.comment_id}},components:{}},n=a,l=(i("8b6b"),i("0b56")),c=Object(l["a"])(n,s,r,!1,null,"a81eecfc",null);e["a"]=c.exports},2618:function(t,e,i){"use strict";i("d41f")},"56c9":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return t.publish_flag?e("div",{staticClass:"form_editor"},[e("div",{staticClass:"editor"},[e("quill-editor",{staticClass:"form_editor_block",model:{value:t.form.content,callback:function(e){t.$set(t.form,"content","string"===typeof e?e.trim():e)},expression:"form.content"}})],1),e("div",{staticClass:"btn_publish"},[e("b-button",{attrs:{variant:"outline-primary",block:""},on:{click:function(e){return t.publish()}}},[e("span",[t._v("发表")])])],1)]):t._e()},r=[],o=i("c6e7"),a={mixins:[o["a"]],props:{form:{type:Object,default(){return{content:""}}},post_url:{type:String,default(){return""}},publish_flag:{type:Boolean,default(){return!0}}},data(){return{}},methods:{async publish(){if(this.user.user_id){var t=this.form;if(t=Object.assign(t,{user_id:this.user.user_id,avatar:this.user.avatar,nickname:this.user.nickname}),t.content){var e=await this.filterSensitiveWords(t.content);if(e.length>0)this.$toast("当前消息中包含敏感词: "+e.join(","));else{var i=this.post_url;i||(i="~/api/comment/add?"),this.$post(i,t,t=>{t.result?(this.$emit("update_comment"),this.form.content=""):t.error&&this.$toast(t.error.message)})}}else this.$toast("输入内容不能为空")}else this.$router.push("/account/login")}},components:{}},n=a,l=(i("9ce5"),i("0b56")),c=Object(l["a"])(n,s,r,!1,null,"7c3a8630",null);e["a"]=c.exports},"8b6b":function(t,e,i){"use strict";i("ec52")},"9ce5":function(t,e,i){"use strict";i("c1b1")},b17a:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"diy_details page_music_information",attrs:{id:"music_information_details"}},[e("div",{staticClass:"warp_dt_box"},[e("div",{staticClass:"warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"card_music_information"},[e("div_music_information",{attrs:{obj:t.obj}})],1)])])])]),t.$check_action("/comment/list","get")?e("div",{staticClass:"warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row review"},[e("div",{staticClass:"col"},[t.list_comment.length?e("bar_title",{staticClass:"mt",attrs:{title:"评论区"}}):t._e(),t.list_comment.length?e("div",{staticClass:"comment_box"},[e("list_comment",{staticClass:"w-100",attrs:{list:t.list_comment,obj:t.form_comment}}),e("b-pagination-nav",{attrs:{"base-url":t.$route.path,"number-of-pages":t.count_pages,"link-gen":t.link_gen,"first-number":"","last-number":""},on:{change:t.change_page}})],1):t._e(),e("div",{staticClass:"form_editor form_edit_box"},[e("div",{staticClass:"details_form_editor_title"},[t._v("发表评论")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fl ml-3 answer_title"},[t._v(" 对 "),e("i",[t._v(t._s(t.respondent))]),t._v(" 回复: ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fr mr-3"},[e("b-button",{attrs:{variant:"outline-primary reset_answer_personnel",size:"sm"},on:{click:function(e){t.form_comment.reply_to_id=0}}},[t._v("重置回复人 ")])],1),e("form_editor",{staticClass:"fn",attrs:{form:t.form_comment},on:{update_comment:t.update_comment}})],1)],1)])])]):t._e()])])},r=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"diy_details_box diy_div_music_information"},[e("div",{staticClass:"warp diy_warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"details_title"},[t._v("详情")]),e("div",{staticClass:"row row_det"},[e("div",{staticClass:"row_top_wrap"},[t.imgList.length?e("div",{staticClass:"row_1"},t._l(t.imgList,(function(i,s){return e("div",{key:i+s,staticClass:"diy_img"},[e("img",{attrs:{src:t.$fullUrl(t.obj[i.name])}})])})),0):t._e(),e("div",{staticClass:"row_2",class:{flex_row2:!t.imgList.length}},[t._l(t.itemList,(function(i,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.$check_field("get",i.name),expression:"$check_field('get',item.name)"}],key:i+s,staticClass:"row_cont",class:{flex_row2_item:!t.imgList.length}},[e("div",{staticClass:"view"},[e("div",{staticClass:"diy_title"},[e("span",[t._v(t._s(i.title)+":")])]),"UID"==i.type?e("div",{staticClass:"diy_field diy_uid",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.get_user_info(i.name,t.obj[i.name]))+" ")])]):"视频"==i.type?e("div",{staticClass:"diy_field diy_video",class:{flex_row2_item_text:t.imgList.length}},[t.obj[i.name]?e("router-link",{attrs:{to:"/media/video?filename="+t.$fullUrl(t.obj[i.name])}},[e("span",[t._v(" 查看视频 ")])]):t._e()],1):"音频"==i.type?e("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:t.imgList.length}},[t.obj[i.name]?e("audio",{staticStyle:{"text-align":"left"},attrs:{src:t.$fullUrl(t.obj[i.name]),controls:""}}):t._e()]):"文件"==i.type?e("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:t.imgList.length}},[e("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:t.$fullUrl(t.obj[i.name]),target:"_blank"}},[t._v("点击下载")])]):"日期"==i.type?e("div",{staticClass:"diy_field diy_date",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"yyyy-MM-dd"))+" ")])]):"时间"==i.type?e("div",{staticClass:"diy_field diy_time",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"hh:mm:ss"))+" ")])]):"日长"==i.type?e("div",{staticClass:"diy_field diy_datetime",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"yyyy-MM-dd hh:mm:ss"))+" ")])]):"电话"==i.type||"手机"==i.type?e("div",{staticClass:"diy_field diy_phone",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])]):"数字"==i.type?e("div",{staticClass:"diy_field diy_number",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])]):"网址"==i.type?e("div",{staticClass:"diy_field diy_url",class:{flex_row2_item_text:t.imgList.length}},[e("div",[e("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:t.obj[i.name],target:"_blank"}},[t._v(t._s(t.obj[i.name]))])])]):"多文本"==i.type?e("div",{staticClass:"diy_field diy_desc",class:{flex_row2_item_text:t.imgList.length}},[e("div",[t._v(" "+t._s(t.obj[i.name])+" ")])]):e("div",{staticClass:"diy_field diy_text",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])])])])})),e("div",{staticClass:"view praise_wrap"},[e("span",{staticClass:"diy_title"},[t._v("点赞数：")]),t._v(" "),e("span",{staticClass:"diy_field diy_text"},[t._v(" "+t._s(t.praiseLen)+" ")])])],2)]),e("div",{staticClass:"details_btn_wrap"},[t.$check_action("/music_information/details","set")?e("button",{staticClass:"btn btn-primary details_btn",on:{click:function(e){return t.change_praise()}}},[e("span",[t._v("点赞")])]):t._e(),t.$check_action("/music_information/details","set")?e("button",{staticClass:"btn btn-primary details_btn",on:{click:function(e){return t.change_collect()}}},[e("span",[t._v("收藏")])]):t._e()]),t._l(t.richList,(function(i,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.$check_field("get",i.name),expression:"$check_field('get',item.name)"}],key:i+s,staticClass:"rich_text"},[e("div",{staticClass:"view"},[e("div",{staticClass:"diy_title"},[e("span",{domProps:{textContent:t._s(i.title)}})]),e("div",{staticClass:"diy_html",domProps:{innerHTML:t._s(t.obj[i.name])}})])])}))],2)])])])},a=[],n=i("6265"),l=i("c6e7"),c={mixins:[n["a"],l["a"]],components:{},props:{obj:{type:Object,default:function(){return{}}}},data(){return{praiseLen:this.obj["praise_len"],imgList:[{title:"歌曲图片",name:"song_image",type:"图片"}],itemList:[{title:"歌曲名称",name:"song_title",type:"爬虫"},{title:"歌手名称",name:"singer_name",type:"爬虫"},{title:"专辑名称",name:"album_name",type:"爬虫"},{title:"发布时间",name:"release_time",type:"爬虫"},{title:"歌词内容",name:"lyrics_content",type:"爬虫"}],richList:[]}},methods:{get_user_info(t,e){var i=null,s="";return i&&(s=i.nickname+"-"+i.username),s},change_praise(t){var e=this.user.user_id,i={source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],user_id:e},s=this;this.state_praise?(this.state_praise=!1,this.$get("~/api/praise/del?",i,t=>{if(t.result){s.praiseLen=parseInt(s.praiseLen)-1;var e=s.praiseLen;this.$post("~/api/music_information/set?music_information_id="+s.obj["music_information_id"],{praise_len:e},t=>{t.result?console.log("添加点赞数状态：",t.result):t.error&&console.error(t.error)}),this.$message.success("取消点赞")}else t.error&&(this.$toast(t.error.message),console.error(t.error))})):(this.state_praise=!0,this.$post("~/api/praise/add?",i,t=>{if(t.result){s.praiseLen=parseInt(s.praiseLen)+1;var e=s.praiseLen;this.$post("~/api/music_information/set?music_information_id="+s.obj["music_information_id"],{praise_len:e},t=>{t.result?console.log("添加点赞数状态：",t.result):t.error&&console.error(t.error)}),this.$message.success("点赞成功")}else t.error&&(this.$toast(t.error.message),console.error(t.error))}))},get_praise(){var t=this.$store.state.user.user_id;this.$get("~/api/praise/count?",{source_table:"music_information",source_field:"music_information_id",source_id:this.obj.music_information_id,user_id:t},t=>{t.result||0===t.result?(console.log("sadsfasf"+JSON.stringify(t)),this.state_praise=!!t.result,console.log("点赞状态：",this.state_praise)):t.error&&(this.$toast(t.error.message),console.error(t.error))})},change_collect(){var t=this.user.user_id,e={source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],user_id:t};this.state_collect?(this.state_collect=!1,this.$get("~/api/collect/del?",e,t=>{t.result?this.$message.success("取消收藏"):t.error&&(this.$toast(t.error.message),console.error(t.error))})):(this.state_collect=!0,this.$post("~/api/collect/add?",e,t=>{t.result?this.$message.success("收藏成功"):t.error&&(this.$toast(t.error.message),console.error(t.error))}))},check_collect(){var t=this.$store.state.user.user_id,e=this.obj.music_information_id;this.$get("~/api/collect/count?",{user_id:t,source_table:"music_information",source_field:"music_information_id",source_id:e},t=>{this.state_collect=t.result})}},created(){setTimeout(()=>{this.get_praise(),this.check_collect()},1e3)},watch:{obj:{deep:!0,handler(){this.praiseLen=this.obj["praise_len"]}}}},_=c,m=(i("0a59"),i("0b56")),u=Object(m["a"])(_,o,a,!1,null,null,null),d=u.exports,f=i("0ff7"),p=i("a3ca"),h=i("56c9"),v={mixins:[l["a"]],components:{list_comment:f["a"],bar_title:p["a"],form_editor:h["a"],div_music_information:d},data(){return{url_get_obj:"~/api/music_information/get_obj?",field:"music_information_id",obj:{praise_len:0},query:{song_title:"",singer_name:"",album_name:"",release_time:"",song_image:"",lyrics_content:"",music_information_id:0},praise:0,state_praise:!1,state_collect:!1,list_comment:[],form_comment:{source_table:"music_information",source_field:"music_information_id",source_id:0,reply_to_id:0},count_pages:1}},methods:{add_hits(t){t["hits"]=t["hits"]+1;var e=t["hits"];this.$post("~/api/music_information/set?music_information_id="+t["music_information_id"],{hits:e},t=>{if(t.result){console.log("添加访问量状态：",t.result);var e={source_table:"music_information",source_field:"music_information_id",source_id:this.obj.music_information_id,user_id:this.$store.state.user.user_id};this.$post("~/api/hits/add?",e,t=>{console.log(t)})}else t.error&&console.error(t.error)})},get_obj_after(t){if(t&&t.result&&t.result.obj){console.log(t.result.obj);var e=t.result.obj;this.obj=e,this.add_hits(e),this.get_praise(e),this.get_collect(e),this.get_comment(e),this.form_comment.source_id=this.obj.music_information_id}},get_collect(t){var e=this.user.user_id,i={source_table:"music_information",source_field:"music_information_id",source_id:t["music_information_id"],user_id:e};this.$get("~/api/collect/count?",i,t=>{if(console.log(t),t.result||0===t.result){var e=!!t.result;this.state_collect=e,console.log("收藏状态："+e)}else t.error&&console.error(t.error)})},toShare(t){window.open(t)},change_collect(){var t=this.user.user_id,e={source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],user_id:t};this.state_collect?(this.state_collect=!1,this.$get("~/api/collect/del?",e,t=>{t.result?this.$toast("取消收藏"):t.error&&(this.$toast(t.error.message),console.error(t.error))})):(this.state_collect=!0,this.$post("~/api/collect/add?",e,t=>{t.result?this.$toast("收藏成功"):t.error&&(this.$toast(t.error.message),console.error(t.error))}))},get_praise(t){var e=this.user.user_id;this.$get("~/api/praise/count?",{source_table:"music_information",source_field:"music_information_id",source_id:t["music_information_id"]},t=>{t.result||0===t.result?(this.praise=t.result,console.log("点赞数：",t.result)):t.error&&(this.$toast(t.error.message),console.error(t.error))}),this.$get("~/api/praise/count?",{source_table:"music_information",source_field:"music_information_id",source_id:t["music_information_id"],user_id:e},t=>{t.result||0===t.result?(this.state_praise=!!t.result,console.log("点赞状态：",t.result)):t.error&&(this.$toast(t.error.message),console.error(t.error))})},change_praise(t){var e=this.user.user_id,i={source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],user_id:e},s=this;s.obj.praise_len=parseInt(s.obj.praise_len),this.state_praise?(this.state_praise=!1,this.$get("~/api/praise/del?",i,t=>{if(t.result){var e=s.obj.praise_len-1;this.$post("~/api/music_information/set?music_information_id="+s.obj["music_information_id"],{praise_len:e},t=>{t.result?console.log("添加点赞数状态：",t.result):t.error&&console.error(t.error)}),this.$toast("取消点赞")}else t.error&&(this.$toast(t.error.message),console.error(t.error))})):(this.state_praise=!0,this.$post("~/api/praise/add?",i,t=>{if(t.result){var e=s.obj.praise_len+1;this.$post("~/api/music_information/set?music_information_id="+s.obj["music_information_id"],{praise_len:e},t=>{t.result?console.log("添加点赞数状态：",t.result):t.error&&console.error(t.error)}),this.$toast("点赞成功")}else t.error&&(this.$toast(t.error.message),console.error(t.error))}))},link_gen(t){return{query:this.query}},change_page(t){this.get_comment(this.obj,t),this.form_comment.reply_to_id=0},update_comment(){this.get_comment(this.obj)},get_comment(t,e=1,i=5){this.$get("~/api/comment/get_list?",{source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],page:e,size:i,reply_to_id:"0",orderby:"create_time desc"},t=>{if(t.result){var e=t.result.list;e.map(t=>{t.list_reply=[]}),this.add_reply(e).then(t=>{this.list_comment=t}),this.count_pages=Math.ceil(t.result.count/i)||1}})},add_reply(t){return new Promise(e=>{for(let i=0;i<t.length;i++){const e=t[i];this.$get("~/api/comment/get_list?",{source_table:"music_information",source_field:"music_information_id",source_id:this.obj["music_information_id"],orderby:"create_time desc",reply_to_id:e.comment_id},t=>{t.result&&(e.list_reply=t.result.list)})}e(t)})}},computed:{respondent(){var t=this.form_comment.reply_to_id,e="";return this.list_comment.map(i=>{i.comment_id===t&&(e=i.nickname)}),e}},mounted(){}},g=v,b=(i("2618"),Object(m["a"])(g,s,r,!1,null,null,null));e["default"]=b.exports},bcc0:function(t,e,i){},c1b1:function(t,e,i){},d41f:function(t,e,i){},ec52:function(t,e,i){}}]);