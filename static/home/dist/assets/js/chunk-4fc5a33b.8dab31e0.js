(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fc5a33b"],{"0ff7":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"list_comment"},e._l(e.list,(function(s,i){return t("div",{key:i,staticClass:"item_comment_box"},[t("div",{staticClass:"comment"},[t("div",{staticClass:"left_block"},[t("img",{directives:[{name:"default-img",rawName:"v-default-img",value:"../../../public/img/default.png",expression:"'../../../public/img/default.png'"}],staticStyle:{width:"4rem",height:"4rem"},attrs:{src:e.$fullUrl(s[e.vm.avatar])}})]),t("div",{staticClass:"right_block"},[t("div",{staticClass:"top_comment"},[t("div",{staticClass:"nickname"},[e._v(e._s(s[e.vm.nickname]))]),t("div",{staticClass:"time_block"},[t("div",{staticClass:"time"},[e._v(" "+e._s(e._f("formatDate")(s[e.vm.create_time]))+" ")])])]),t("div",{staticClass:"content",domProps:{innerHTML:e._s(s[e.vm.content])}}),Object.keys(e.obj).length?t("div",{staticClass:"comment_reply"},[t("b-button",{attrs:{variant:"outline"},on:{click:function(t){return e.reply_to_sb(s)}}},[e._v("回复")])],1):e._e()])]),s.list_reply?t("div",{staticClass:"list_reply ml-5"},e._l(s.list_reply,(function(s,i){return t("div",{key:i,staticClass:"mb"},[t("div",{staticClass:"fl"},[t("span",{staticClass:"nickname"},[e._v(e._s(s[e.vm.nickname]))])]),t("div",{staticClass:"fr"},[t("span",{staticClass:"time"},[e._v(e._s(e._f("formatDate")(s[e.vm.create_time])))])]),t("div",{staticClass:"ml-5",domProps:{innerHTML:e._s(s[e.vm.content])}})])})),0):e._e()])})),0)},n=[],a=s("c6e7"),r={mixins:[a["a"]],props:{list:{type:Array,default:function(){return[]}},obj:{type:Object,default:function(){return{}}},vm:{type:Object,default:function(){return{avatar:"avatar",nickname:"nickname",content:"content",create_time:"create_time"}}}},data(){return{text:""}},methods:{reply_to_sb(e){this.obj.reply_to_id=e.comment_id}},components:{}},o=r,l=(s("8b6b"),s("0b56")),_=Object(l["a"])(o,i,n,!1,null,"a81eecfc",null);t["a"]=_.exports},"272a":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"diy_details page_website_announcement",attrs:{id:"website_announcement_details"}},[t("div",{staticClass:"warp"},[t("div",{staticClass:"container"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("div",{staticClass:"card_website_announcement"},[t("div_website_announcement",{attrs:{obj:e.obj}})],1)])])])]),e.$check_action("/comment/list","get")?t("div",{staticClass:"warp"},[t("div",{staticClass:"container"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[e.list_comment.length?t("bar_title",{staticClass:"mt",attrs:{title:"评论区"}}):e._e(),e.list_comment.length?t("div",{staticClass:"comment_box"},[t("list_comment",{staticClass:"w-100",attrs:{list:e.list_comment,obj:e.form_comment}}),t("b-pagination-nav",{attrs:{"base-url":e.$route.path,"number-of-pages":e.count_pages,"link-gen":e.link_gen,"first-number":"","last-number":""},on:{change:e.change_page}})],1):e._e(),t("div",{staticClass:"form_editor form_edit_box"},[t("div",{staticClass:"details_form_editor_title"},[e._v("发表评论")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fl ml-3 answer_title"},[e._v(" 对 "),t("i",[e._v(e._s(e.respondent))]),e._v(" 回复: ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fr mr-3"},[t("b-button",{attrs:{variant:"outline-primary reset_answer_personnel",size:"sm"},on:{click:function(t){e.form_comment.reply_to_id=0}}},[e._v("重置回复人 ")])],1),t("form_editor",{staticClass:"fn",attrs:{form:e.form_comment},on:{update_comment:e.update_comment}})],1)],1)])])]):e._e()])},n=[],a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"diy_details_box diy_div_website_announcement"},[t("div",{staticClass:"warp"},[t("div",{staticClass:"container"},[t("div",{staticClass:"details_title"},[e._v("详情")]),t("div",{staticClass:"row"},[t("div",{staticClass:"row_top_wrap"},[e.imgList.length?t("div",{staticClass:"row_1"},e._l(e.imgList,(function(s,i){return t("div",{key:s+i,staticClass:"diy_img"},[t("img",{attrs:{src:e.$fullUrl(e.obj[s.name])}})])})),0):e._e(),t("div",{staticClass:"row_2",class:{flex_row2:!e.imgList.length}},e._l(e.itemList,(function(s,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.$check_field("get",s.name),expression:"$check_field('get',item.name)"}],key:s+i,class:{flex_row2_item:!e.imgList.length}},[t("div",{staticClass:"view"},[t("div",{staticClass:"diy_title"},[t("span",[e._v(e._s(s.title)+":")])]),"UID"==s.type?t("div",{staticClass:"diy_field diy_uid",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.get_user_info(s.name,e.obj[s.name]))+" ")])]):"视频"==s.type?t("div",{staticClass:"diy_field diy_video",class:{flex_row2_item_text:e.imgList.length}},[e.obj[s.name]?t("router-link",{attrs:{to:"/media/video?filename="+e.$fullUrl(e.obj[s.name])}},[t("span",[e._v(" 查看视频 ")])]):e._e()],1):"音频"==s.type?t("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:e.imgList.length}},[e.obj[s.name]?t("audio",{staticStyle:{"text-align":"left"},attrs:{src:e.$fullUrl(e.obj[s.name]),controls:""}}):e._e()]):"文件"==s.type?t("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:e.imgList.length}},[t("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:e.$fullUrl(e.obj[s.name]),target:"_blank"}},[e._v("点击下载")])]):"日期"==s.type?t("div",{staticClass:"diy_field diy_date",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.$toTime(e.obj[s.name],"yyyy-MM-dd"))+" ")])]):"时间"==s.type?t("div",{staticClass:"diy_field diy_time",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.$toTime(e.obj[s.name],"hh:mm:ss"))+" ")])]):"日长"==s.type?t("div",{staticClass:"diy_field diy_datetime",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.$toTime(e.obj[s.name],"yyyy-MM-dd hh:mm:ss"))+" ")])]):"电话"==s.type||"手机"==s.type?t("div",{staticClass:"diy_field diy_phone",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.obj[s.name])+" ")])]):"数字"==s.type?t("div",{staticClass:"diy_field diy_number",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.obj[s.name])+" ")])]):"网址"==s.type?t("div",{staticClass:"diy_field diy_url",class:{flex_row2_item_text:e.imgList.length}},[t("div",[t("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:e.obj[s.name],target:"_blank"}},[e._v(e._s(e.obj[s.name]))])])]):"多文本"==s.type?t("div",{staticClass:"diy_field diy_desc",class:{flex_row2_item_text:e.imgList.length}},[t("div",[e._v(" "+e._s(e.obj[s.name])+" ")])]):t("div",{staticClass:"diy_field diy_text",class:{flex_row2_item_text:e.imgList.length}},[t("span",[e._v(" "+e._s(e.obj[s.name])+" ")])])])])})),0)]),t("div",{staticClass:"view praise_wrap"},[t("span",{staticClass:"diy_title"},[e._v("点赞数：")]),e._v(" "),t("span",{staticClass:"diy_field diy_text"},[e._v(" "+e._s(e.praiseLen)+" ")])]),t("div",{staticClass:"details_btn_wrap"},[e.$check_action("/website_announcement/details","set")?t("button",{staticClass:"btn btn-primary details_btn",on:{click:function(t){return e.change_praise()}}},[e._v("点赞")]):e._e()]),e._l(e.richList,(function(s,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.$check_field("get",s.name),expression:"$check_field('get',item.name)"}],key:s+i,staticClass:"rich_text"},[t("div",{staticClass:"view"},[t("div",{staticClass:"diy_title"},[t("span",{domProps:{textContent:e._s(s.title)}})]),t("div",{staticClass:"diy_html",domProps:{innerHTML:e._s(e.obj[s.name])}})])])}))],2)])])])},r=[],o=s("6265"),l=s("c6e7"),_={mixins:[o["a"],l["a"]],components:{},props:{obj:{type:Object,default:function(){return{}}}},data(){return{praiseLen:this.obj["praise_len"],imgList:[],itemList:[{title:"标题",name:"title",type:"文本"},{title:"发布人",name:"publisher",type:"文本"},{title:"发布时间",name:"release_time",type:"日长"},{title:"相关附件",name:"relevant_accessories",type:"文件"},{title:"下多测试",name:"lower_multi_test",type:"下多"}],richList:[{title:"详情",name:"details",type:"编辑"}]}},methods:{get_user_info(e,t){var s=null,i="";return s&&(i=s.nickname+"-"+s.username),i},change_praise(e){var t=this.user.user_id,s={source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj["website_announcement_id"],user_id:t},i=this;this.state_praise?(this.state_praise=!1,this.$get("~/api/praise/del?",s,e=>{if(e.result){i.praiseLen=parseInt(i.praiseLen)-1;var t=i.praiseLen;this.$post("~/api/website_announcement/set?website_announcement_id="+i.obj["website_announcement_id"],{praise_len:t},e=>{e.result?console.log("添加点赞数状态：",e.result):e.error&&console.error(e.error)}),this.$message.success("取消点赞")}else e.error&&(this.$toast(e.error.message),console.error(e.error))})):(this.state_praise=!0,this.$post("~/api/praise/add?",s,e=>{if(e.result){i.praiseLen=parseInt(i.praiseLen)+1;var t=i.praiseLen;this.$post("~/api/website_announcement/set?website_announcement_id="+i.obj["website_announcement_id"],{praise_len:t},e=>{e.result?console.log("添加点赞数状态：",e.result):e.error&&console.error(e.error)}),this.$message.success("点赞成功")}else e.error&&(this.$toast(e.error.message),console.error(e.error))}))},get_praise(){var e=this.$store.state.user.user_id;this.$get("~/api/praise/count?",{source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj.website_announcement_id,user_id:e},e=>{e.result||0===e.result?(console.log("sadsfasf"+JSON.stringify(e)),this.state_praise=!!e.result,console.log("点赞状态：",this.state_praise)):e.error&&(this.$toast(e.error.message),console.error(e.error))})}},created(){setTimeout(()=>{this.get_praise()},1e3)},watch:{obj:{deep:!0,handler(){this.praiseLen=this.obj["praise_len"]}}}},c=_,m=(s("490b"),s("0b56")),d=Object(m["a"])(c,a,r,!1,null,null,null),u=d.exports,p=s("0ff7"),b=s("a3ca"),h=s("56c9"),f={mixins:[l["a"]],components:{list_comment:p["a"],bar_title:b["a"],form_editor:h["a"],div_website_announcement:u},data(){return{url_get_obj:"~/api/website_announcement/get_obj?",field:"website_announcement_id",obj:{praise_len:0},query:{title:"",publisher:"",release_time:"",relevant_accessories:"",details:"",lower_multi_test:"",website_announcement_id:0},praise:0,state_praise:!1,list_comment:[],form_comment:{source_table:"website_announcement",source_field:"website_announcement_id",source_id:0,reply_to_id:0},count_pages:1}},methods:{add_hits(e){e["hits"]=e["hits"]+1;var t=e["hits"];this.$post("~/api/website_announcement/set?website_announcement_id="+e["website_announcement_id"],{hits:t},e=>{if(e.result){console.log("添加访问量状态：",e.result);var t={source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj.website_announcement_id,user_id:this.$store.state.user.user_id};this.$post("~/api/hits/add?",t,e=>{console.log(e)})}else e.error&&console.error(e.error)})},get_obj_after(e){if(e&&e.result&&e.result.obj){console.log(e.result.obj);var t=e.result.obj;this.obj=t,this.add_hits(t),this.get_praise(t),this.get_comment(t),this.form_comment.source_id=this.obj.website_announcement_id}},get_praise(e){var t=this.user.user_id;this.$get("~/api/praise/count?",{source_table:"website_announcement",source_field:"website_announcement_id",source_id:e["website_announcement_id"]},e=>{e.result||0===e.result?(this.praise=e.result,console.log("点赞数：",e.result)):e.error&&(this.$toast(e.error.message),console.error(e.error))}),this.$get("~/api/praise/count?",{source_table:"website_announcement",source_field:"website_announcement_id",source_id:e["website_announcement_id"],user_id:t},e=>{e.result||0===e.result?(this.state_praise=!!e.result,console.log("点赞状态：",e.result)):e.error&&(this.$toast(e.error.message),console.error(e.error))})},change_praise(e){var t=this.user.user_id,s={source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj["website_announcement_id"],user_id:t},i=this;i.obj.praise_len=parseInt(i.obj.praise_len),this.state_praise?(this.state_praise=!1,this.$get("~/api/praise/del?",s,e=>{if(e.result){var t=i.obj.praise_len-1;this.$post("~/api/website_announcement/set?website_announcement_id="+i.obj["website_announcement_id"],{praise_len:t},e=>{e.result?console.log("添加点赞数状态：",e.result):e.error&&console.error(e.error)}),this.$toast("取消点赞")}else e.error&&(this.$toast(e.error.message),console.error(e.error))})):(this.state_praise=!0,this.$post("~/api/praise/add?",s,e=>{if(e.result){var t=i.obj.praise_len+1;this.$post("~/api/website_announcement/set?website_announcement_id="+i.obj["website_announcement_id"],{praise_len:t},e=>{e.result?console.log("添加点赞数状态：",e.result):e.error&&console.error(e.error)}),this.$toast("点赞成功")}else e.error&&(this.$toast(e.error.message),console.error(e.error))}))},link_gen(e){return{query:this.query}},change_page(e){this.get_comment(this.obj,e),this.form_comment.reply_to_id=0},update_comment(){this.get_comment(this.obj)},get_comment(e,t=1,s=5){this.$get("~/api/comment/get_list?",{source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj["website_announcement_id"],page:t,size:s,reply_to_id:"0",orderby:"create_time desc"},e=>{if(e.result){var t=e.result.list;t.map(e=>{e.list_reply=[]}),this.add_reply(t).then(e=>{this.list_comment=e}),this.count_pages=Math.ceil(e.result.count/s)||1}})},add_reply(e){return new Promise(t=>{for(let s=0;s<e.length;s++){const t=e[s];this.$get("~/api/comment/get_list?",{source_table:"website_announcement",source_field:"website_announcement_id",source_id:this.obj["website_announcement_id"],orderby:"create_time desc",reply_to_id:t.comment_id},e=>{e.result&&(t.list_reply=e.result.list)})}t(e)})}},computed:{respondent(){var e=this.form_comment.reply_to_id,t="";return this.list_comment.map(s=>{s.comment_id===e&&(t=s.nickname)}),t}},mounted(){}},v=f,g=(s("3948"),Object(m["a"])(v,i,n,!1,null,null,null));t["default"]=g.exports},3948:function(e,t,s){"use strict";s("e1bd")},"490b":function(e,t,s){"use strict";s("554c")},"554c":function(e,t,s){},"56c9":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return e.publish_flag?t("div",{staticClass:"form_editor"},[t("div",{staticClass:"editor"},[t("quill-editor",{staticClass:"form_editor_block",model:{value:e.form.content,callback:function(t){e.$set(e.form,"content","string"===typeof t?t.trim():t)},expression:"form.content"}})],1),t("div",{staticClass:"btn_publish"},[t("b-button",{attrs:{variant:"outline-primary",block:""},on:{click:function(t){return e.publish()}}},[e._v("发表")])],1)]):e._e()},n=[],a=s("6265"),r={mixins:[a["a"]],props:{form:{type:Object,default(){return{content:""}}},post_url:{type:String,default(){return""}},publish_flag:{type:Boolean,default(){return!0}}},data(){return{}},methods:{publish(){if(this.user.user_id){var e=this.form;if(e=Object.assign(e,{user_id:this.user.user_id,avatar:this.user.avatar,nickname:this.user.nickname}),e.content){var t=this.post_url;t||(t="~/api/comment/add?"),this.$post(t,e,e=>{e.result?(this.$emit("update_comment"),this.form.content=""):e.error&&this.$toast(e.error.message)})}else this.$toast("输入内容不能为空")}else this.$router.push("/account/login")}},components:{}},o=r,l=(s("594d"),s("0b56")),_=Object(l["a"])(o,i,n,!1,null,"0c92ffb8",null);t["a"]=_.exports},"594d":function(e,t,s){"use strict";s("b1fc")},"8b6b":function(e,t,s){"use strict";s("ec52")},b1fc:function(e,t,s){},e1bd:function(e,t,s){},ec52:function(e,t,s){}}]);