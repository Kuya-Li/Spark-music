(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dfc6681"],{"517e":function(e,s,t){},a1b1:function(e,s,t){"use strict";t("517e")},a620:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-main",{staticClass:"bg edit_wrap answer_edit_wrap"},[t("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"","label-width":"70px"}},[t("el-row",{staticClass:"row_e"},[e.if_answered?t("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:24,lg:24}},[0===e.score_state?t("div",{staticClass:"title_margin",staticStyle:{"margin-bottom":"20px"}},[e._v("未评分")]):t("div",{staticClass:"title_margin",staticStyle:{"margin-bottom":"20px"}},[e._v("已评分，得分："),t("span",{staticStyle:{color:"red"}},[e._v(e._s(e.answer_form.score))])])]):e._e(),e._l(e.question_list,(function(s,r){return t("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:24,lg:24}},["单选题"===s.type?t("div",{staticClass:"title_margin"},[e._v(" "+e._s(s.question_order+".单选题："+s.title+" ("+s.score+"分)")+" "),e.if_answered?t("span",{staticClass:"score_show"},[e._v("--------"+e._s(e.answer_scores[r])+"分")]):e._e()]):"多选题"===s.type?t("div",{staticClass:"title_margin"},[e._v(" "+e._s(s.question_order+".多选题："+s.title+" ("+s.score+"分)")+" "),e.if_answered?t("span",{staticClass:"score_show"},[e._v("--------"+e._s(e.answer_scores[r])+"分")]):e._e()]):"判断题"===s.type?t("div",{staticClass:"title_margin"},[e._v(" "+e._s(s.question_order+".判断题："+s.title+" ("+s.score+"分)")+" "),e.if_answered?t("span",{staticClass:"score_show"},[e._v("--------"+e._s(e.answer_scores[r])+"分")]):e._e()]):"填空题"===s.type?t("div",{staticClass:"title_margin"},[e._v(" "+e._s(s.question_order+".填空题："+s.title+" ("+s.score+"分)")+" "),e.if_answered?t("span",{staticClass:"score_show"},[0===e.score_state?t("span",[e._v("--------未评分")]):t("span",[e._v("--------"+e._s(e.answer_scores[r])+"分")])]):e._e()]):t("div",{staticClass:"title_margin"},[e._v(" "+e._s(s.question_order+".主观题："+s.title+" ("+s.score+"分)")+" "),e.if_answered?t("span",{staticClass:"score_show"},[0===e.score_state?t("span",[e._v("--------未评分")]):t("span",[e._v("--------"+e._s(e.answer_scores[r])+"分")])]):e._e()]),"单选题"===s.type?t("el-form-item",{attrs:{label:""}},[e._l(e.get_question_list(s.question_item),(function(s){return t("el-radio",{attrs:{disabled:e.if_answered,label:s},model:{value:e.answers[r],callback:function(s){e.$set(e.answers,r,s)},expression:"answers[i]"}},[e._v(e._s(s))])})),e.if_answered&&e.reference_answers[r]?t("div",{staticClass:"score_show"},[e._v(" 参考答案："+e._s(e.reference_answers[r])+" ")]):e._e()],2):"多选题"===s.type?t("el-form-item",{attrs:{label:""}},[t("el-checkbox-group",{attrs:{disabled:e.if_answered},model:{value:e.answers[r],callback:function(s){e.$set(e.answers,r,s)},expression:"answers[i]"}},e._l(e.get_question_list(s.question_item),(function(e){return t("el-checkbox",{attrs:{label:e}})})),1),e.if_answered&&e.reference_answers[r]?t("div",{staticClass:"score_show"},[e._v(" 参考答案："+e._s(e.reference_answers[r])+" ")]):e._e()],1):"判断题"===s.type?t("el-form-item",{attrs:{label:""}},[e._l(e.get_question_list(s.question_item),(function(s){return t("el-radio",{attrs:{disabled:e.if_answered,label:s},model:{value:e.answers[r],callback:function(s){e.$set(e.answers,r,s)},expression:"answers[i]"}},[e._v(e._s(s))])})),e.if_answered&&e.reference_answers[r]?t("div",{staticClass:"score_show"},[e._v(" 参考答案："+e._s(e.reference_answers[r])+" ")]):e._e()],2):"填空题"===s.type?t("el-form-item",{attrs:{label:""}},[t("el-input",{staticStyle:{width:"500px"},attrs:{disabled:e.if_answered},model:{value:e.answers[r],callback:function(s){e.$set(e.answers,r,s)},expression:"answers[i]"}}),e.if_answered?t("div",{staticClass:"score_show"},[e._v(" 参考答案："+e._s(e.reference_answers[r])+" ")]):e._e()],1):t("el-form-item",{attrs:{label:""}},[t("el-input",{attrs:{disabled:e.if_answered,type:"textarea"},model:{value:e.answers[r],callback:function(s){e.$set(e.answers,r,s)},expression:"answers[i]"}}),e.if_answered?t("div",{staticClass:"score_show"},[e._v(" 参考答案："+e._s(e.reference_answers[r])+" ")]):e._e()],1)],1)})),t("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:24,lg:24}},[t("el-form-item",{attrs:{label:"提交人"}},[t("el-input",{attrs:{disabled:""},model:{value:e.submit_user_str,callback:function(s){e.submit_user_str=s},expression:"submit_user_str"}})],1)],1)],2),t("el-col",{staticClass:"el_form_btn_warp",attrs:{xs:24,sm:24,lg:24}},[t("el-form-item",[t("el-col",{staticClass:"el_form_btn el_form_btn_1",attrs:{xs:24,sm:24,lg:12}},[e.if_answered?e._e():t("el-button",{staticStyle:{width:"100%",float:"left"},attrs:{type:"primary"},on:{click:function(s){return e.submit()}}},[e._v("提交 ")])],1),t("el-col",{staticClass:"el_form_btn el_form_btn_2",attrs:{xs:24,sm:24,lg:12}},[t("el-button",{staticStyle:{width:"100%",float:"right"},on:{click:function(s){return e.cancel()}}},[e._v("取消")])],1)],1)],1)],1),e.if_answered?e._e():t("div",{staticClass:"countdown"},[e._v(" 距离考试结束还有："),t("span",[e._v(e._s(e.minutes+":"+e.seconds))])])],1)},a=[],i=(t("ac1f"),t("1276"),t("96cf"),t("1da1")),n=t("c6e7"),o={mixins:[n["a"]],data:function(){return{field:"exam_id",url_add:"~/api/user_answer/add?",url_set:"~/api/user_answer/set?",url_get_obj:"~/api/exam/get_obj?",url_upload:"~/api/user_answer/upload?",query:{exam_id:0},form:{exam_id:0,name:"",duration:0,score:0,status:"启用"},url_get_question_list:"~/api/exam_question/get_list?",question_list:[],answers:[],submit_user_str:"",answer_form:{user_answer_id:0,user_id:0,exam_id:0,score:0,score_state:0,answers:[],score_detail:[],objective_score:0,subjective_score:0,nickname:""},if_answered:!1,maxtime:0,minutes:0,seconds:0,timer:"",score_state:0,answer_scores:[],reference_answers:[]}},methods:{get_obj_after:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var t,r,a,i,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$get("~/api/user/get_obj?user_id="+e.$store.state.user.user_id);case 2:return t=s.sent,t.result?(e.submit_user_str=t.result.obj.username+"-"+t.result.obj.nickname,e.answer_form.user_id=t.result.obj.user_id,e.answer_form.nickname=t.result.obj.nickname):t.error&&console.error(t.error),s.next=6,e.$get(e.url_get_question_list+"exam_id="+e.query.exam_id+"&orderby=question_order");case 6:if(r=s.sent,r.result)for(e.question_list=r.result.list,a=0;a<e.question_list.length;a++)"多选题"===e.question_list[a].type?e.answers[a]=[]:e.answers[a]="";else r.error&&console.error(r.error);return s.next=10,e.$get("~/api/user_answer/get_obj?user_id="+e.answer_form.user_id+"&exam_id="+e.query.exam_id);case 10:if(i=s.sent,i.result&&null!=i.result.obj){for(e.answer_form=i.result.obj,e.score_state=i.result.obj.score_state,e.answer_form.answers=JSON.parse(e.answer_form.answers),e.answer_form.score_detail=JSON.parse(e.answer_form.score_detail),n=0;n<e.answer_form.answers.length;n++)e.answers[n]=e.answer_form.answers[n].answer,e.answer_scores[n]=e.answer_form.score_detail[n].score,"单选题"===e.question_list[n].type||"判断题"===e.question_list[n].type||"多选题"===e.question_list[n].type?e.answer_scores[n]!==e.question_list[n].score&&(e.reference_answers[n]=e.question_list[n].answer):e.reference_answers[n]=e.question_list[n].answer;e.if_answered=!0}else i.error&&console.error(i.error);e.if_answered||(e.maxtime=60*e.form.duration,e.timer=window.setInterval((function(){setTimeout(e.set_countdown(),0)}),1e3));case 13:case"end":return s.stop()}}),s)})))()},get_question_list:function(e){var s=e.split("\n");return s},submit_main:function(){var e=this;e.answer_form.exam_id=e.query.exam_id;for(var s=0;s<e.answers.length;s++){var t={exam_question_id:e.question_list[s].exam_question_id,answer:e.answers[s]};if(e.answer_form.answers[s]=t,"单选题"===e.question_list[s].type||"判断题"===e.question_list[s].type)if(e.answers[s]===e.question_list[s].answer){var r={exam_question_id:e.question_list[s].exam_question_id,score:e.question_list[s].score};e.answer_form.score_detail[s]=r,e.answer_form.objective_score=parseFloat(e.answer_form.objective_score)+parseFloat(e.question_list[s].score)}else{var a={exam_question_id:e.question_list[s].exam_question_id,score:0};e.answer_form.score_detail[s]=a}else if("多选题"===e.question_list[s].type){var i=!0,n=e.question_list[s].answer.split("|");if(e.answers[s].length!==n.length)i=!1;else for(var o=0;o<n.length;o++)if(-1===e.answers[s].indexOf(n[o])){i=!1;break}if(i){var _={exam_question_id:e.question_list[s].exam_question_id,score:e.question_list[s].score};e.answer_form.score_detail[s]=_,e.answer_form.objective_score=parseFloat(e.answer_form.objective_score)+parseFloat(e.question_list[s].score)}else{var l={exam_question_id:e.question_list[s].exam_question_id,score:0};e.answer_form.score_detail[s]=l}}else{var c={exam_question_id:e.question_list[s].exam_question_id,score:0};e.answer_form.score_detail[s]=c}}e.answer_form.answers=JSON.stringify(e.answer_form.answers),e.answer_form.score_detail=JSON.stringify(e.answer_form.score_detail),e.answer_form.score=parseFloat(e.answer_form.subjective_score)+parseFloat(e.answer_form.objective_score);var u=e.url_add;this.$post(u,e.answer_form,(function(s,t){console.log("提交结果：",s),s.result?e.events("submit_after",s,null):s.error&&e.$toast(s.error.message,"danger")}))},set_countdown:function(){this.maxtime>=0?(this.minutes=Math.floor(this.maxtime/60),this.seconds=Math.floor(this.maxtime%60),--this.maxtime):(clearInterval(this.timer),alert("时间到，结束!"))}},created:function(){}},_=o,l=(t("a1b1"),t("2877")),c=Object(l["a"])(_,r,a,!1,null,null,null);s["default"]=c.exports}}]);